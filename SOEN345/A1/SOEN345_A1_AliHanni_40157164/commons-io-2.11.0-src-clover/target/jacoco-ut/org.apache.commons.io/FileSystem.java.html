<?xml version="1.0" encoding="iso-8859-1"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>FileSystem.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Apache Commons IO</a> &gt; <a href="index.source.html" class="el_package">org.apache.commons.io</a> &gt; <span class="el_source">FileSystem.java</span></div><h1>FileSystem.java</h1><pre class="source lang-java linenums">/* $$ This file has been instrumented by Clover 4.4.1#2019101123313948 $$ *//*
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the &quot;License&quot;); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package org.apache.commons.io;

import java.util.Arrays;
import java.util.Locale;
import java.util.Objects;

/**
 * Abstracts an OS' file system details, currently supporting the single use case of converting a file name String to a
 * legal file name with {@link #toLegalFileName(String, char)}.
 * &lt;p&gt;
 * The starting point of any operation is {@link #getCurrent()} which gets you the enum for the file system that matches
 * the OS hosting the running JVM.
 * &lt;/p&gt;
 *
 * @since 2.7
 */
<span class="fc" id="L34">public enum FileSystem {</span>

    /**
     * Generic file system.
     */
<span class="fc" id="L39">    GENERIC(false, false, Integer.MAX_VALUE, Integer.MAX_VALUE, new char[] { 0 }, new String[] {}, false),</span>

    /**
     * Linux file system.
     */
<span class="fc" id="L44">    LINUX(true, true, 255, 4096, new char[] {</span>
            // KEEP THIS ARRAY SORTED!
            // @formatter:off
            // ASCII NUL
            0,
             '/'
            // @formatter:on
    }, new String[] {}, false),

    /**
     * MacOS file system.
     */
<span class="fc" id="L56">    MAC_OSX(true, true, 255, 1024, new char[] {</span>
            // KEEP THIS ARRAY SORTED!
            // @formatter:off
            // ASCII NUL
            0,
            '/',
             ':'
            // @formatter:on
    }, new String[] {}, false),

    /**
     * Windows file system.
     * &lt;p&gt;
     * The reserved characters are defined in the
     * &lt;a href=&quot;https://docs.microsoft.com/en-us/windows/win32/fileio/naming-a-file&quot;&gt;Naming Conventions
     * (microsoft.com)&lt;/a&gt;.
     * &lt;/p&gt;
     *
     * @see &lt;a href=&quot;https://docs.microsoft.com/en-us/windows/win32/fileio/naming-a-file&quot;&gt;Naming Conventions
     *      (microsoft.com)&lt;/a&gt;
     */
<span class="fc" id="L77">    WINDOWS(false, true, 255,</span>
            32000, new char[] {
                    // KEEP THIS ARRAY SORTED!
                    // @formatter:off
                    // ASCII NUL
                    0,
                    // 1-31 may be allowed in file streams
                    1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28,
                    29, 30, 31,
                    '&quot;', '*', '/', ':', '&lt;', '&gt;', '?', '\\', '|'
                    // @formatter:on
            }, // KEEP THIS ARRAY SORTED!
            new String[] { &quot;AUX&quot;, &quot;COM1&quot;, &quot;COM2&quot;, &quot;COM3&quot;, &quot;COM4&quot;, &quot;COM5&quot;, &quot;COM6&quot;, &quot;COM7&quot;, &quot;COM8&quot;, &quot;COM9&quot;, &quot;CON&quot;, &quot;LPT1&quot;,
                    &quot;LPT2&quot;, &quot;LPT3&quot;, &quot;LPT4&quot;, &quot;LPT5&quot;, &quot;LPT6&quot;, &quot;LPT7&quot;, &quot;LPT8&quot;, &quot;LPT9&quot;, &quot;NUL&quot;, &quot;PRN&quot; }, true);

    /**
     * &lt;p&gt;
     * Is {@code true} if this is Linux.
     * &lt;/p&gt;
     * &lt;p&gt;
     * The field will return {@code false} if {@code OS_NAME} is {@code null}.
     * &lt;/p&gt;
     */
<span class="fc" id="L100">    private static final boolean IS_OS_LINUX = getOsMatchesName(&quot;Linux&quot;);</span>

    /**
     * &lt;p&gt;
     * Is {@code true} if this is Mac.
     * &lt;/p&gt;
     * &lt;p&gt;
     * The field will return {@code false} if {@code OS_NAME} is {@code null}.
     * &lt;/p&gt;
     */
<span class="fc" id="L110">    private static final boolean IS_OS_MAC = getOsMatchesName(&quot;Mac&quot;);</span>

    /**
     * The prefix String for all Windows OS.
     */
    private static final String OS_NAME_WINDOWS_PREFIX = &quot;Windows&quot;;

    /**
     * &lt;p&gt;
     * Is {@code true} if this is Windows.
     * &lt;/p&gt;
     * &lt;p&gt;
     * The field will return {@code false} if {@code OS_NAME} is {@code null}.
     * &lt;/p&gt;
     */
<span class="fc" id="L125">    private static final boolean IS_OS_WINDOWS = getOsMatchesName(OS_NAME_WINDOWS_PREFIX);</span>

    /**
     * Gets the current file system.
     *
     * @return the current file system
     */
<span class="fc" id="L132">    public static FileSystem getCurrent() {try{__CLR4_4_1cfcfkylvdyhn.R.inc(447);</span>
<span class="pc bpc" id="L133" title="7 of 10 branches missed.">        __CLR4_4_1cfcfkylvdyhn.R.inc(448);if ((((IS_OS_LINUX)&amp;&amp;(__CLR4_4_1cfcfkylvdyhn.R.iget(449)!=0|true))||(__CLR4_4_1cfcfkylvdyhn.R.iget(450)==0&amp;false))) {{</span>
<span class="nc" id="L134">            __CLR4_4_1cfcfkylvdyhn.R.inc(451);return LINUX;</span>
        }
<span class="pc bpc" id="L136" title="7 of 10 branches missed.">        }__CLR4_4_1cfcfkylvdyhn.R.inc(452);if ((((IS_OS_MAC)&amp;&amp;(__CLR4_4_1cfcfkylvdyhn.R.iget(453)!=0|true))||(__CLR4_4_1cfcfkylvdyhn.R.iget(454)==0&amp;false))) {{</span>
<span class="fc" id="L137">            __CLR4_4_1cfcfkylvdyhn.R.inc(455);return FileSystem.MAC_OSX;</span>
        }
<span class="nc bnc" id="L139" title="All 10 branches missed.">        }__CLR4_4_1cfcfkylvdyhn.R.inc(456);if ((((IS_OS_WINDOWS)&amp;&amp;(__CLR4_4_1cfcfkylvdyhn.R.iget(457)!=0|true))||(__CLR4_4_1cfcfkylvdyhn.R.iget(458)==0&amp;false))) {{</span>
<span class="nc" id="L140">            __CLR4_4_1cfcfkylvdyhn.R.inc(459);return FileSystem.WINDOWS;</span>
        }
<span class="nc" id="L142">        }__CLR4_4_1cfcfkylvdyhn.R.inc(460);return GENERIC;</span>
<span class="fc" id="L143">    }finally{__CLR4_4_1cfcfkylvdyhn.R.flushNeeded();}}</span>

    /**
     * Decides if the operating system matches.
     *
     * @param osNamePrefix
     *            the prefix for the os name
     * @return true if matches, or false if not or can't determine
     */
<span class="fc" id="L152">    private static boolean getOsMatchesName(final String osNamePrefix) {try{__CLR4_4_1cfcfkylvdyhn.R.inc(461);</span>
<span class="fc" id="L153">        __CLR4_4_1cfcfkylvdyhn.R.inc(462);return isOsNameMatch(getSystemProperty(&quot;os.name&quot;), osNamePrefix);</span>
<span class="fc" id="L154">    }finally{__CLR4_4_1cfcfkylvdyhn.R.flushNeeded();}}</span>

    /**
     * &lt;p&gt;
     * Gets a System property, defaulting to {@code null} if the property cannot be read.
     * &lt;/p&gt;
     * &lt;p&gt;
     * If a {@code SecurityException} is caught, the return value is {@code null} and a message is written to
     * {@code System.err}.
     * &lt;/p&gt;
     *
     * @param property
     *            the system property name
     * @return the system property value or {@code null} if a security problem occurs
     */
<span class="fc" id="L169">    private static String getSystemProperty(final String property) {try{__CLR4_4_1cfcfkylvdyhn.R.inc(463);</span>
<span class="fc" id="L170">        __CLR4_4_1cfcfkylvdyhn.R.inc(464);try {</span>
<span class="fc" id="L171">            __CLR4_4_1cfcfkylvdyhn.R.inc(465);return System.getProperty(property);</span>
<span class="nc" id="L172">        } catch (final SecurityException ex) {</span>
            // we are not allowed to look at this property
<span class="nc" id="L174">            __CLR4_4_1cfcfkylvdyhn.R.inc(466);System.err.println(&quot;Caught a SecurityException reading the system property '&quot; + property</span>
                    + &quot;'; the SystemUtils property value will default to null.&quot;);
<span class="nc" id="L176">            __CLR4_4_1cfcfkylvdyhn.R.inc(467);return null;</span>
        }
<span class="fc" id="L178">    }finally{__CLR4_4_1cfcfkylvdyhn.R.flushNeeded();}}</span>

    /**
     * Decides if the operating system matches.
     * &lt;p&gt;
     * This method is package private instead of private to support unit test invocation.
     * &lt;/p&gt;
     *
     * @param osName
     *            the actual OS name
     * @param osNamePrefix
     *            the prefix for the expected OS name
     * @return true if matches, or false if not or can't determine
     */
<span class="fc" id="L192">    private static boolean isOsNameMatch(final String osName, final String osNamePrefix) {try{__CLR4_4_1cfcfkylvdyhn.R.inc(468);</span>
<span class="pc bpc" id="L193" title="7 of 10 branches missed.">        __CLR4_4_1cfcfkylvdyhn.R.inc(469);if ((((osName == null)&amp;&amp;(__CLR4_4_1cfcfkylvdyhn.R.iget(470)!=0|true))||(__CLR4_4_1cfcfkylvdyhn.R.iget(471)==0&amp;false))) {{</span>
<span class="nc" id="L194">            __CLR4_4_1cfcfkylvdyhn.R.inc(472);return false;</span>
        }
<span class="fc" id="L196">        }__CLR4_4_1cfcfkylvdyhn.R.inc(473);return osName.toUpperCase(Locale.ROOT).startsWith(osNamePrefix.toUpperCase(Locale.ROOT));</span>
<span class="fc" id="L197">    }finally{__CLR4_4_1cfcfkylvdyhn.R.flushNeeded();}}</span>

    private final boolean casePreserving;
    private final boolean caseSensitive;
    private final char[] illegalFileNameChars;
    private final int maxFileNameLength;
    private final int maxPathLength;
    private final String[] reservedFileNames;
    private final boolean supportsDriveLetter;

    /**
     * Constructs a new instance.
     *
     * @param caseSensitive Whether this file system is case sensitive.
     * @param casePreserving Whether this file system is case preserving.
     * @param maxFileLength The maximum length for file names. The file name does not include folders.
     * @param maxPathLength The maximum length of the path to a file. This can include folders.
     * @param illegalFileNameChars Illegal characters for this file system.
     * @param reservedFileNames The reserved file names.
     * @param supportsDriveLetter Whether this file system support driver letters.
     */
    FileSystem(final boolean caseSensitive, final boolean casePreserving, final int maxFileLength,
        final int maxPathLength, final char[] illegalFileNameChars, final String[] reservedFileNames,
<span class="fc" id="L220">        final boolean supportsDriveLetter) {try{__CLR4_4_1cfcfkylvdyhn.R.inc(474);</span>
<span class="fc" id="L221">        __CLR4_4_1cfcfkylvdyhn.R.inc(475);this.maxFileNameLength = maxFileLength;</span>
<span class="fc" id="L222">        __CLR4_4_1cfcfkylvdyhn.R.inc(476);this.maxPathLength = maxPathLength;</span>
<span class="fc" id="L223">        __CLR4_4_1cfcfkylvdyhn.R.inc(477);this.illegalFileNameChars = Objects.requireNonNull(illegalFileNameChars, &quot;illegalFileNameChars&quot;);</span>
<span class="fc" id="L224">        __CLR4_4_1cfcfkylvdyhn.R.inc(478);this.reservedFileNames = Objects.requireNonNull(reservedFileNames, &quot;reservedFileNames&quot;);</span>
<span class="fc" id="L225">        __CLR4_4_1cfcfkylvdyhn.R.inc(479);this.caseSensitive = caseSensitive;</span>
<span class="fc" id="L226">        __CLR4_4_1cfcfkylvdyhn.R.inc(480);this.casePreserving = casePreserving;</span>
<span class="fc" id="L227">        __CLR4_4_1cfcfkylvdyhn.R.inc(481);this.supportsDriveLetter = supportsDriveLetter;</span>
<span class="fc" id="L228">    }finally{__CLR4_4_1cfcfkylvdyhn.R.flushNeeded();}}</span>

    /**
     * Gets a cloned copy of the illegal characters for this file system.
     *
     * @return the illegal characters for this file system.
     */
<span class="fc" id="L235">    public char[] getIllegalFileNameChars() {try{__CLR4_4_1cfcfkylvdyhn.R.inc(482);</span>
<span class="fc" id="L236">        __CLR4_4_1cfcfkylvdyhn.R.inc(483);return this.illegalFileNameChars.clone();</span>
<span class="fc" id="L237">    }finally{__CLR4_4_1cfcfkylvdyhn.R.flushNeeded();}}</span>

    /**
     * Gets the maximum length for file names. The file name does not include folders.
     *
     * @return the maximum length for file names.
     */
<span class="nc" id="L244">    public int getMaxFileNameLength() {try{__CLR4_4_1cfcfkylvdyhn.R.inc(484);</span>
<span class="nc" id="L245">        __CLR4_4_1cfcfkylvdyhn.R.inc(485);return maxFileNameLength;</span>
<span class="nc" id="L246">    }finally{__CLR4_4_1cfcfkylvdyhn.R.flushNeeded();}}</span>

    /**
     * Gets the maximum length of the path to a file. This can include folders.
     *
     * @return the maximum length of the path to a file.
     */
<span class="nc" id="L253">    public int getMaxPathLength() {try{__CLR4_4_1cfcfkylvdyhn.R.inc(486);</span>
<span class="nc" id="L254">        __CLR4_4_1cfcfkylvdyhn.R.inc(487);return maxPathLength;</span>
<span class="nc" id="L255">    }finally{__CLR4_4_1cfcfkylvdyhn.R.flushNeeded();}}</span>

    /**
     * Gets a cloned copy of the reserved file names.
     *
     * @return the reserved file names.
     */
<span class="fc" id="L262">    public String[] getReservedFileNames() {try{__CLR4_4_1cfcfkylvdyhn.R.inc(488);</span>
<span class="fc" id="L263">        __CLR4_4_1cfcfkylvdyhn.R.inc(489);return reservedFileNames.clone();</span>
<span class="fc" id="L264">    }finally{__CLR4_4_1cfcfkylvdyhn.R.flushNeeded();}}</span>

    /**
     * Whether this file system preserves case.
     *
     * @return Whether this file system preserves case.
     */
<span class="nc" id="L271">    public boolean isCasePreserving() {try{__CLR4_4_1cfcfkylvdyhn.R.inc(490);</span>
<span class="nc" id="L272">        __CLR4_4_1cfcfkylvdyhn.R.inc(491);return casePreserving;</span>
<span class="nc" id="L273">    }finally{__CLR4_4_1cfcfkylvdyhn.R.flushNeeded();}}</span>

    /**
     * Whether this file system is case-sensitive.
     *
     * @return Whether this file system is case-sensitive.
     */
<span class="nc" id="L280">    public boolean isCaseSensitive() {try{__CLR4_4_1cfcfkylvdyhn.R.inc(492);</span>
<span class="nc" id="L281">        __CLR4_4_1cfcfkylvdyhn.R.inc(493);return caseSensitive;</span>
<span class="nc" id="L282">    }finally{__CLR4_4_1cfcfkylvdyhn.R.flushNeeded();}}</span>

    /**
     * Returns {@code true} if the given character is illegal in a file name, {@code false} otherwise.
     *
     * @param c
     *            the character to test
     * @return {@code true} if the given character is illegal in a file name, {@code false} otherwise.
     */
<span class="fc" id="L291">    private boolean isIllegalFileNameChar(final char c) {try{__CLR4_4_1cfcfkylvdyhn.R.inc(494);</span>
<span class="fc bfc" id="L292" title="All 2 branches covered.">        __CLR4_4_1cfcfkylvdyhn.R.inc(495);return Arrays.binarySearch(illegalFileNameChars, c) &gt;= 0;</span>
<span class="fc" id="L293">    }finally{__CLR4_4_1cfcfkylvdyhn.R.flushNeeded();}}</span>

    /**
     * Checks if a candidate file name (without a path) such as {@code &quot;filename.ext&quot;} or {@code &quot;filename&quot;} is a
     * potentially legal file name. If the file name length exceeds {@link #getMaxFileNameLength()}, or if it contains
     * an illegal character then the check fails.
     *
     * @param candidate
     *            a candidate file name (without a path) like {@code &quot;filename.ext&quot;} or {@code &quot;filename&quot;}
     * @return {@code true} if the candidate name is legal
     */
<span class="fc" id="L304">    public boolean isLegalFileName(final CharSequence candidate) {try{__CLR4_4_1cfcfkylvdyhn.R.inc(496);</span>
<span class="pc bpc" id="L305" title="5 of 14 branches missed.">        __CLR4_4_1cfcfkylvdyhn.R.inc(497);if ((((candidate == null || candidate.length() == 0 || candidate.length() &gt; maxFileNameLength)&amp;&amp;(__CLR4_4_1cfcfkylvdyhn.R.iget(498)!=0|true))||(__CLR4_4_1cfcfkylvdyhn.R.iget(499)==0&amp;false))) {{</span>
<span class="fc" id="L306">            __CLR4_4_1cfcfkylvdyhn.R.inc(500);return false;</span>
        }
<span class="pc bpc" id="L308" title="4 of 10 branches missed.">        }__CLR4_4_1cfcfkylvdyhn.R.inc(501);if ((((isReservedFileName(candidate))&amp;&amp;(__CLR4_4_1cfcfkylvdyhn.R.iget(502)!=0|true))||(__CLR4_4_1cfcfkylvdyhn.R.iget(503)==0&amp;false))) {{</span>
<span class="fc" id="L309">            __CLR4_4_1cfcfkylvdyhn.R.inc(504);return false;</span>
        }
<span class="pc bpc" id="L311" title="4 of 10 branches missed.">        }__CLR4_4_1cfcfkylvdyhn.R.inc(505);for (int i = 0; (((i &lt; candidate.length())&amp;&amp;(__CLR4_4_1cfcfkylvdyhn.R.iget(506)!=0|true))||(__CLR4_4_1cfcfkylvdyhn.R.iget(507)==0&amp;false)); i++) {{</span>
<span class="pc bpc" id="L312" title="4 of 10 branches missed.">            __CLR4_4_1cfcfkylvdyhn.R.inc(508);if ((((isIllegalFileNameChar(candidate.charAt(i)))&amp;&amp;(__CLR4_4_1cfcfkylvdyhn.R.iget(509)!=0|true))||(__CLR4_4_1cfcfkylvdyhn.R.iget(510)==0&amp;false))) {{</span>
<span class="fc" id="L313">                __CLR4_4_1cfcfkylvdyhn.R.inc(511);return false;</span>
            }
        }}
<span class="fc" id="L316">        }__CLR4_4_1cfcfkylvdyhn.R.inc(512);return true;</span>
<span class="fc" id="L317">    }finally{__CLR4_4_1cfcfkylvdyhn.R.flushNeeded();}}</span>

    /**
     * Returns whether the given string is a reserved file name.
     *
     * @param candidate
     *            the string to test
     * @return {@code true} if the given string is a reserved file name.
     */
<span class="fc" id="L326">    public boolean isReservedFileName(final CharSequence candidate) {try{__CLR4_4_1cfcfkylvdyhn.R.inc(513);</span>
<span class="fc bfc" id="L327" title="All 2 branches covered.">        __CLR4_4_1cfcfkylvdyhn.R.inc(514);return Arrays.binarySearch(reservedFileNames, candidate) &gt;= 0;</span>
<span class="fc" id="L328">    }finally{__CLR4_4_1cfcfkylvdyhn.R.flushNeeded();}}</span>

    /**
     * Tests whether this file system support driver letters.
     * &lt;p&gt;
     * Windows supports driver letters as do other operating systems. Whether these other OS's still support Java like
     * OS/2, is a different matter.
     * &lt;/p&gt;
     *
     * @return whether this file system support driver letters.
     * @since 2.9.0
     * @see &lt;a href=&quot;https://en.wikipedia.org/wiki/Drive_letter_assignment&quot;&gt;Operating systems that use drive letter
     *      assignment&lt;/a&gt;
     */
<span class="fc" id="L342">    public boolean supportsDriveLetter() {try{__CLR4_4_1cfcfkylvdyhn.R.inc(515);</span>
<span class="fc" id="L343">        __CLR4_4_1cfcfkylvdyhn.R.inc(516);return supportsDriveLetter;</span>
<span class="fc" id="L344">    }finally{__CLR4_4_1cfcfkylvdyhn.R.flushNeeded();}}</span>

    /**
     * Converts a candidate file name (without a path) like {@code &quot;filename.ext&quot;} or {@code &quot;filename&quot;} to a legal file
     * name. Illegal characters in the candidate name are replaced by the {@code replacement} character. If the file
     * name length exceeds {@link #getMaxFileNameLength()}, then the name is truncated to
     * {@link #getMaxFileNameLength()}.
     *
     * @param candidate
     *            a candidate file name (without a path) like {@code &quot;filename.ext&quot;} or {@code &quot;filename&quot;}
     * @param replacement
     *            Illegal characters in the candidate name are replaced by this character
     * @return a String without illegal characters
     */
<span class="fc" id="L358">    public String toLegalFileName(final String candidate, final char replacement) {try{__CLR4_4_1cfcfkylvdyhn.R.inc(517);</span>
<span class="pc bpc" id="L359" title="4 of 10 branches missed.">        __CLR4_4_1cfcfkylvdyhn.R.inc(518);if ((((isIllegalFileNameChar(replacement))&amp;&amp;(__CLR4_4_1cfcfkylvdyhn.R.iget(519)!=0|true))||(__CLR4_4_1cfcfkylvdyhn.R.iget(520)==0&amp;false))) {{</span>
<span class="fc" id="L360">            __CLR4_4_1cfcfkylvdyhn.R.inc(521);throw new IllegalArgumentException(</span>
<span class="fc" id="L361">                    String.format(&quot;The replacement character '%s' cannot be one of the %s illegal characters: %s&quot;,</span>
                            // %s does not work properly with NUL
<span class="pc bpc" id="L363" title="7 of 10 branches missed.">                            (((replacement == '\0' )&amp;&amp;(__CLR4_4_1cfcfkylvdyhn.R.iget(522)!=0|true))||(__CLR4_4_1cfcfkylvdyhn.R.iget(523)==0&amp;false))? &quot;\\0&quot; : replacement, name(), Arrays.toString(illegalFileNameChars)));</span>
        }
<span class="pc bpc" id="L365" title="7 of 10 branches missed.">        }__CLR4_4_1cfcfkylvdyhn.R.inc(524);final String truncated = (((candidate.length() &gt; maxFileNameLength )&amp;&amp;(__CLR4_4_1cfcfkylvdyhn.R.iget(525)!=0|true))||(__CLR4_4_1cfcfkylvdyhn.R.iget(526)==0&amp;false))? candidate.substring(0, maxFileNameLength)</span>
<span class="fc" id="L366">                : candidate;</span>
<span class="fc" id="L367">        __CLR4_4_1cfcfkylvdyhn.R.inc(527);boolean changed = false;</span>
<span class="fc" id="L368">        __CLR4_4_1cfcfkylvdyhn.R.inc(528);final char[] charArray = truncated.toCharArray();</span>
<span class="pc bpc" id="L369" title="4 of 10 branches missed.">        __CLR4_4_1cfcfkylvdyhn.R.inc(529);for (int i = 0; (((i &lt; charArray.length)&amp;&amp;(__CLR4_4_1cfcfkylvdyhn.R.iget(530)!=0|true))||(__CLR4_4_1cfcfkylvdyhn.R.iget(531)==0&amp;false)); i++) {{</span>
<span class="pc bpc" id="L370" title="4 of 10 branches missed.">            __CLR4_4_1cfcfkylvdyhn.R.inc(532);if ((((isIllegalFileNameChar(charArray[i]))&amp;&amp;(__CLR4_4_1cfcfkylvdyhn.R.iget(533)!=0|true))||(__CLR4_4_1cfcfkylvdyhn.R.iget(534)==0&amp;false))) {{</span>
<span class="fc" id="L371">                __CLR4_4_1cfcfkylvdyhn.R.inc(535);charArray[i] = replacement;</span>
<span class="fc" id="L372">                __CLR4_4_1cfcfkylvdyhn.R.inc(536);changed = true;</span>
            }
        }}
<span class="pc bpc" id="L375" title="4 of 10 branches missed.">        }__CLR4_4_1cfcfkylvdyhn.R.inc(537);return (((changed )&amp;&amp;(__CLR4_4_1cfcfkylvdyhn.R.iget(538)!=0|true))||(__CLR4_4_1cfcfkylvdyhn.R.iget(539)==0&amp;false))? String.valueOf(charArray) : truncated;</span>
<span class="fc" id="L376">    }finally{__CLR4_4_1cfcfkylvdyhn.R.flushNeeded();}}</span>
<span class="pc bpc" id="L377" title="3 of 4 branches missed.">;public static class __CLR4_4_1cfcfkylvdyhn{public static com_atlassian_clover.CoverageRecorder R;public static com_atlassian_clover.CloverProfile[] profiles = { };@java.lang.SuppressWarnings(&quot;unchecked&quot;) public static &lt;I, T extends I&gt; I lambdaInc(final int i,final T l,final int si){java.lang.reflect.InvocationHandler h=new java.lang.reflect.InvocationHandler(){public java.lang.Object invoke(java.lang.Object p,java.lang.reflect.Method m,java.lang.Object[] a) throws Throwable{R.inc(i);R.inc(si);try{return m.invoke(l,a);}catch(java.lang.reflect.InvocationTargetException e){throw e.getCause()!=null?e.getCause():new RuntimeException(&quot;Clover failed to invoke instrumented lambda&quot;,e);}}};return (I)java.lang.reflect.Proxy.newProxyInstance(l.getClass().getClassLoader(),l.getClass().getInterfaces(),h);}static{com_atlassian_clover.CoverageRecorder _R=null;try{com_atlassian_clover.CloverVersionInfo.An_old_version_of_clover_is_on_your_compilation_classpath___Please_remove___Required_version_is___4_4_1();if(2019101123313948L!=com_atlassian_clover.CloverVersionInfo.getBuildStamp()){com_atlassian_clover.Clover.l(&quot;[CLOVER] WARNING: The Clover version used in instrumentation does not match the runtime version. You need to run instrumented classes against the same version of Clover that you instrumented with.&quot;);com_atlassian_clover.Clover.l(&quot;[CLOVER] WARNING: Instr=4.4.1#2019101123313948,Runtime=&quot;+com_atlassian_clover.CloverVersionInfo.getReleaseNum()+&quot;#&quot;+com_atlassian_clover.CloverVersionInfo.getBuildStamp());}R=com_atlassian_clover.Clover.getNullRecorder();_R=com_atlassian_clover.Clover.getNullRecorder();_R=com_atlassian_clover.Clover.getRecorder(&quot;\u002f\u0055\u0073\u0065\u0072\u0073\u002f\u0061\u006c\u0069\u0068\u0061\u006e\u006e\u0069\u002f\u0044\u0065\u0073\u006b\u0074\u006f\u0070\u002f\u0047\u0069\u0074\u0048\u0075\u0062\u002f\u0053\u004f\u0045\u004e\u002f\u0053\u004f\u0045\u004e\u0033\u0034\u0035\u002f\u0041\u0031\u002f\u0063\u006f\u006d\u006d\u006f\u006e\u0073\u002d\u0069\u006f\u002d\u0032\u002e\u0031\u0031\u002e\u0030\u002d\u0073\u0072\u0063\u002f\u0074\u0061\u0072\u0067\u0065\u0074\u002f\u0063\u006c\u006f\u0076\u0065\u0072\u002f\u0063\u006c\u006f\u0076\u0065\u0072\u002e\u0064\u0062&quot;,1642616389890L,8589935092L,540,profiles,new java.lang.String[]{&quot;clover.distributed.coverage&quot;,null});}catch(java.lang.SecurityException e){java.lang.System.err.println(&quot;[CLOVER] FATAL ERROR: Clover could not be initialised because it has insufficient security privileges. Please consult the Clover documentation on the security policy file changes required. (&quot;+e.getClass()+&quot;:&quot;+e.getMessage()+&quot;)&quot;);}catch(java.lang.NoClassDefFoundError e){java.lang.System.err.println(&quot;[CLOVER] FATAL ERROR: Clover could not be initialised. Are you sure you have Clover in the runtime classpath? (&quot;+e.getClass()+&quot;:&quot;+e.getMessage()+&quot;)&quot;);}catch(java.lang.Throwable t){java.lang.System.err.println(&quot;[CLOVER] FATAL ERROR: Clover could not be initialised because of an unexpected error. (&quot;+t.getClass()+&quot;:&quot;+t.getMessage()+&quot;)&quot;);}R=_R;}}public static final com_atlassian_clover.TestNameSniffer __CLR4_4_1_TEST_NAME_SNIFFER=com_atlassian_clover.TestNameSniffer.NULL_INSTANCE;}</span>
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>