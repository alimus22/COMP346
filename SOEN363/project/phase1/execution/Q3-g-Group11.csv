Group  (cost=2205708.05..2205907.40 rows=9406 width=25) (actual time=121.970..122.325 rows=168 loops=1)
"  Group Key: m1.year, m1.rating, m1.title"
  ->  Sort  (cost=2205708.05..2205757.89 rows=19935 width=25) (actual time=121.966..122.089 rows=1362 loops=1)
"        Sort Key: m1.year, m1.rating, m1.title"
        Sort Method: quicksort  Memory: 151kB
        ->  Nested Loop  (cost=483.47..2204284.40 rows=19935 width=25) (actual time=12.067..120.741 rows=1362 loops=1)
              Join Filter: (((m1.year = m.year) AND (m1.rating = (max(m.rating)))) OR ((m1.year = m_1.year) AND (m1.rating = (min(m_1.rating)))))
              Rows Removed by Join Filter: 498291
              ->  Seq Scan on movies m1  (cost=0.00..182.97 rows=10197 width=25) (actual time=0.030..1.419 rows=10197 loops=1)
              ->  Materialize  (cost=483.47..655.70 rows=9604 width=16) (actual time=0.001..0.005 rows=49 loops=10197)
                    ->  Nested Loop  (cost=483.47..607.68 rows=9604 width=16) (actual time=6.883..6.949 rows=49 loops=1)
                          ->  HashAggregate  (cost=241.73..242.71 rows=98 width=8) (actual time=4.783..4.815 rows=7 loops=1)
                                Group Key: m.year
                                Batches: 1  Memory Usage: 24kB
                                ->  Seq Scan on movies m  (cost=0.00..233.95 rows=1556 width=8) (actual time=0.024..4.154 rows=1556 loops=1)
                                      Filter: ((year >= 2005) AND (year <= 2011))
                                      Rows Removed by Filter: 8641
                          ->  Materialize  (cost=241.73..244.18 rows=98 width=8) (actual time=0.300..0.302 rows=7 loops=7)
                                ->  HashAggregate  (cost=241.73..242.71 rows=98 width=8) (actual time=2.080..2.086 rows=7 loops=1)
                                      Group Key: m_1.year
                                      Batches: 1  Memory Usage: 24kB
                                      ->  Seq Scan on movies m_1  (cost=0.00..233.95 rows=1556 width=8) (actual time=0.026..1.488 rows=1556 loops=1)
                                            Filter: ((year >= 2005) AND (year <= 2011))
                                            Rows Removed by Filter: 8641
Planning Time: 0.998 ms
Execution Time: 122.610 ms
